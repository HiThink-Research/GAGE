api_version: gage/v1alpha1
kind: PipelineConfig
metadata:
  name: arcagi2_openai_litellm
  description: 使用 LiteLLM 加载各种GPT模型进行 ARC-AGI-2 测试集评测。

custom:
  steps:
    - step: inference
    - step: auto_eval

datasets:
  - dataset_id: arcagi2_evaluation
    hub: inline
    loader: arcagi2
    params:
      path: ${ARCAGI2_DATA_PATH:-/mnt/aime_data_ssd/user_workspace/zhangyiwei2/GAGE/ARC-AGI-2/data/evaluation}
      preprocess: arcagi2
      preprocess_kwargs:
        # system_prompt: "You are an AI assistant specialized in visual pattern recognition and abstract reasoning."
        # instruction: "Provide your answer as a 2D JSON array of integers (0-9). Do not include any other text or formatting."

backends:
  - backend_id: arcagi2_openai_litellm_backend
    type: litellm
    config:
      provider: openai
      api_base: ${OPENAI_API_BASE:-https://api.openai.com/v1}
      model: ${GPT_MODEL:-gpt-5.2}
      generation_parameters:
        max_new_tokens: 4096
        temperature: 0.0
        top_p: 1.0
      streaming: false
      max_retries: 6

role_adapters:
  - adapter_id: dut_arcagi2_openai_litellm
    role_type: dut_model
    backend_id: arcagi2_openai_litellm_backend
    capabilities:
      - chat_completion

metrics:
  - metric_id: arcagi2_accuracy
    implementation: arcagi2_accuracy

tasks:
  - task_id: arcagi2_eval_eval
    dataset_id: arcagi2_evaluation
    max_samples: 5
    reporting:
      sinks:
        - type: console
        - type: file
          params:
            output_path: ${GAGE_EVAL_SAVE_DIR:-./runs}/arcagi2_openai_events.jsonl