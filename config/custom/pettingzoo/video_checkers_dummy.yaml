api_version: gage/v1alpha1
kind: PipelineConfig

metadata:
  name: pettingzoo_video_checkers_dummy_demo
  description: PettingZoo Atari video_checkers demo (Dummy Random Agents).

custom:
  steps:
    - step: arena
      adapter_id: pettingzoo_video_checkers_arena
    - step: auto_eval

datasets:
  - dataset_id: pettingzoo_video_checkers_dummy
    loader: jsonl
    params:
      path: tests/data/pettingzoo_atari_demo.jsonl
      streaming: false

backends:
  - backend_id: pz_dummy_player_0
    type: dummy
    config:
      responses: ["0", "1", "2", "3", "4"]
      cycle: true
  - backend_id: pz_dummy_player_1
    type: dummy
    config:
      responses: ["0", "1", "2", "3", "4"]
      cycle: true

role_adapters:
  - adapter_id: pz_dummy_player_0
    role_type: dut_model
    backend_id: pz_dummy_player_0
    capabilities: [chat_completion]
  - adapter_id: pz_dummy_player_1
    role_type: dut_model
    backend_id: pz_dummy_player_1
    capabilities: [chat_completion]

  - adapter_id: pettingzoo_video_checkers_arena
    role_type: arena
    params:
      # action_labels are now automatically resolved from env_id via constants.py
      environment:
        impl: pettingzoo_aec_v1
        env_id: pettingzoo.atari.video_checkers_v4
        env_kwargs:
          render_mode: human
          max_cycles: 300
        seed: 1234
        include_raw_obs: false
        use_action_meanings: false
      rules:
        illegal_policy:
          retry: 1
          on_fail: loss
      scheduler:
        type: turn
        max_turns: 300
      parser:
        impl: discrete_action_parser_v1
      players:
        - name: player_0
          player_id: player_0
          type: backend
          ref: pz_dummy_player_0
          max_retries: 1
          fallback_policy: first_legal
        - name: player_1
          player_id: player_1
          type: backend
          ref: pz_dummy_player_1
          max_retries: 1
          fallback_policy: first_legal


tasks:
  - task_id: pettingzoo_video_checkers_dummy
    dataset_id: pettingzoo_video_checkers_dummy
    max_samples: 1
    concurrency: 1
    reporting:
      sinks:
        - type: console
