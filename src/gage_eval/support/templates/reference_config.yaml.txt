api_version: gage/v1alpha1
kind: PipelineConfig
metadata:
  name: demo_openai
  description: "示例配置：展示 datasets/backends/tasks/metrics 结构"

custom:
  steps:
    - step: inference
    - step: auto_eval

datasets:
  - dataset_id: demo_dataset
    loader: hf_hub
    hub: huggingface
    hub_params:
      hub_id: demo/dataset
      split: test
      trust_remote_code: false
    params:
      preprocess: demo_preproc
      preprocess_kwargs:
        question_field: question
        answers_field: answer

backends:
  - backend_id: demo_backend
    type: openai_http
    config:
      base_url: http://127.0.0.1:1234/v1
      model: gpt-3.5-turbo
      default_params:
        max_new_tokens: 512
        temperature: 0.1

role_adapters:
  - adapter_id: demo_dut
    role_type: dut_model
    backend_id: demo_backend
    capabilities: ['text_chat']

metrics:
  - metric_id: exact_match
    implementation: exact_match
    aggregation: mean

tasks:
  - task_id: demo_eval
    dataset_id: demo_dataset
    max_samples: 5
