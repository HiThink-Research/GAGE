# 12.30 修改日志

## 核心修复 (Core Fixes)

### 1. 循环引用修复 (Circular Imports)
- **问题**：`base_backend.py` 等基类引用 `gage_eval.registry` 导致 "Registry -> Plugin -> BaseClass -> Registry" 循环依赖。
- **修复**：将所有基类和 Mixin (`base_backend.py`, `role/adapters/base.py`, `async_generation_mixin.py`) 中的工具函数引用 (`ensure_async`, `run_sync`) 重构为直接指向轻量级叶子模块 **`gage_eval.registry.utils`**。
- **结果**：消除了循环依赖，同时保持了代码整洁（使用 Top-level import）。

### 2. Sample 类适配 (Sample Adaptation)
- **问题**：`Sample` dataclass 被用户定义为极简模式（缺少 `inputs` 等字段），但 `sample_from_dict` 仍尝试解析这些字段导致报错。
- **修复**：修改 `gage_eval/assets/datasets/sample.py` 中的 `sample_from_dict` 函数，移除对 `Inputs`, `AuditInfo` 等不存在类的引用，使其与极简 `Sample` 类完全匹配。
- **结果**：在保持 `Sample` 类零修改的前提下，修复了数据加载错误。

### 3. Pipeline 数据加载 (Data Loading)
- **修复**：修改 `tests/data/Test_Gomoku_LiteLLM.jsonl`，为样本添加了 dummy system message，解决了 Schema 校验失败导致 "0 samples processed" 的问题。
- **验证**：确认 `DataManager` 能正确读取并转换数据。

## 验证结果 (Verification)
- **Gradio 启动**：成功启动 `gomoku_human_vs_llm` 可视化界面。
- **对局测试**：
  - 成功连接 LiteLLM 后端（GPT-5.2）。
  - 验证了 Human (前端) vs LLM (后端) 的完整交互流程。
  - 游戏逻辑运行正常，无报错。
